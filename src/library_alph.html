<html> 
    <head>
        <meta charset="UTF-8" />
        <title>Library Page</title>
        <link rel="stylesheet" href="css/library.css">
        <script src="js/input.js"></script>
    </head>
    <body>
      <div id="spinning-thingy" onclick="window.open('index.html')">
        <img src = "css/VinylBG2_noBG.png" width="90" height="90">
      </div>
        <h1>Music library</h1>
        <nav>
          <div class="nav-sort-re">
            <a href="library_date.html">Sort by recent</a>
          </div>
        </nav>
        <div id="LIB_container">
        </div>

        <script>
          document.addEventListener('DOMContentLoaded', ()  => {
            let albums = [];
            const container = document.getElementById("LIB_container");
            const albumCount = Number(localStorage.getItem('albumCount'));
            let sort = [];
            for (let i = 0; i < albumCount; i++) {
            sort[i] = localStorage.getItem('albumName' + (i + 1))+ (i + 1)
            }




            sort.sort();



            for (let i = 0; i < albumCount; i++) {
                albums[i] = localStorage.getItem('linkPath' + sort[i].replace(/\D+/g, ''));
                const div = document.createElement("div");
                div.id = "album" + (i + 1); 
                div.classList.add("album");
                div.textContent = localStorage.getItem('albumName' + sort[i].replace(/\D+/g, '')) + " by " + localStorage.getItem('artistName' + sort[i].replace(/\D+/g, ''));
                container.appendChild(div);
            }

            document.addEventListener('click',()=>{
              if(event.target && event.target.classList.contains('album')){
                const number = event.target.id.replace('album','');
                const albumLink = localStorage.getItem('linkPath' + number);
                localStorage.setItem('currentalbum', albumLink);

                alert(localStorage.getItem('currentalbum'));
                const currentalbum = localStorage.getItem('currentalbum').replace(
                  'https://open.spotify.com/album/','').split('?')[0];
                const playerLink = "player.html?id=" + currentalbum

                window.open(playerLink);
              //https://open.spotify.com/album/2164xFQmRLyfnHxqKoFPj5?si=HyvxX_iVS6eB3BNgdkhPxA
              // -> 2164xFQmRLyfnHxqKoFPj5
              }

            })
          });
        </script>
    </body>
</html>
