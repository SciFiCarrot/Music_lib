<!DOCTYPE html>
<html lang="en">
<head>
  <title>Simple Music Player</title>
  <link rel="stylesheet" 
        href=
        "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">


  <link rel="stylesheet" type="text/css" href="css/player.css">
  <link href="input.html">
</head>
<body>
    <div id="spinning-thingy" onclick="window.open('index.html')">
      <img src = "VinylBG2_noBG.png" width="90" height="90">
    </div>
    <div id="embed-iframe" height="80%"></div>

    <script src="https://open.spotify.com/embed/iframe-api/v1" async></script>

    <script>
    //get the id from the url
    // localhost:8080/player.html?id=<id>
    const id = new URLSearchParams(location.search).get("id");



    const callback = (EmbedController) => {
      document.querySelectorAll('.episode').forEach(
        episode => {
          episode.addEventListener('click', () => {
            alert('test')
            EmbedController.togglePlay();
          });
        })
    };



    window.onSpotifyIframeApiReady = (IFrameAPI) => {
      const element = document.getElementById('embed-iframe');
      const uribase = 'spotify:album:'
      const uri = uribase + id
      const options = {
          width: '100%',
          height: '550px',
          uri: uri
        };
      const callback = (EmbedController) => {};
      IFrameAPI.createController(element, options, callback);
    };
      document.addEventListener('DOMContentLoaded', () => {
        const button = document.getElementById('playpause_track');
        const iframe = document.getElementById('spotify_player');

        button.addEventListener('click', () => {
          const link = localStorage.getItem('LinkPath');
          const embedLink = link.replace(
            'https://open.spotify.com/',
            'https://open.spotify.com/embed/'
          );
          iframe.src = embedLink;
          iframe.style.display ='block';
        });
      });
  </script>
</body>
</html>
