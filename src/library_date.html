<html> 
    <head>
        <meta charset="UTF-8" />
        <title>Library Page</title>
        <link rel="stylesheet" href="css/library.css">
        <script src="js/input.js"></script>
    </head>
    <body>
      <div id="spinning-thingy" onclick="window.open('index.html')">
        <img src = "css/VinylBG2_noBG.png" width="90" height="90">
      </div>
        <h1>Music library</h1>
        <nav>
          <div class="nav-sort-re">
            <a href="library_alph.html">Sort Alphabetically</a>
          </div>
        </nav>

        <div id="LIB_container"></div>


          <div class="nav-home">
        </div>
        <script>
          document.addEventListener('DOMContentLoaded', () => {
            let albums = [];
            const container = document.getElementById("LIB_container");
            const albumCount = Number(localStorage.getItem('albumCount'));
            for (let i = 0; i < albumCount; i++) {
                albums[i] = localStorage.getItem('linkPath' + (i + 1));
                const div = document.createElement("div");
                div.id = "album" + (i + 1); 
                div.classList.add("album");
                div.textContent = localStorage.getItem('albumName' + (i + 1)) + " by " + localStorage.getItem('artistName' + (i + 1));
                container.appendChild(div);
            }
            document.addEventListener('click',()=>{
              if(event.target && event.target.classList.contains('album')){
                const number = event.target.id.replace('album','');
                const albumLink = localStorage.getItem('linkPath' + number);
                localStorage.setItem('currentalbum', albumLink);

                const currentalbum = localStorage.getItem('currentalbum')
                
                const albumId = currentalbum.replace(
                  'https://open.spotify.com/album/','').split('?')[0];
                const playerLink = "player.html?id=" + albumId
                window.open(playerLink);
              }
              //https://open.spotify.com/album/2164xFQmRLyfnHxqKoFPj5?si=HyvxX_iVS6eB3BNgdkhPxA
              // -> 2164xFQmRLyfnHxqKoFPj5

            })
          });
        </script>
    </body>
</html>
